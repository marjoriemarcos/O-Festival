{% extends 'front/base.html.twig' %}

{% block ticketingActive %}active
{% endblock %}

{% block main %}

	<div class="container-ticketing medium-blue-bg roboto-font">
		<h2 class="page-title adumu-font">Billetterie</h2>
		<div class="ticket-list row justify-content-around mb-4">

			{% for pass in passes %}
				{% if pass.data is not empty %}
					<!-- Div pour Pass -->
					<div
						class="ticket-card col-lg-4 mt-5">
						<!-- Card Image -->
						<div class="ticket-card-image card img-zoom">
							<img src="{{ pass.image }}" class="card-img-top" alt="">
							<div class="card-img-overlay d-flex justify-content-center align-items-center">
								<h3 class="card-title text-white">{{ pass.title }}</h3>
							</div>
						</div>

						<div class="ticket-card-content open-font dark-blue-bg mx-auto pb-3 text-white">
							<div class="row align-items-center">
								<div
									class="col-md-12 text-center mt-3 pb-3">
									<!-- Afficher les starts_at différents -->
									{% set displayedStarts = [] %}
									{% set displayedCombinations = [] %}

									{% for data in pass.data %}
										{% set startFormatted = data.startAt|date('l j F Y') %}
										{% set endFormatted = data.endAt|date('l j F Y') %}
										{% set combination = startFormatted ~ ' - ' ~ endFormatted %}

										{% if combination not in displayedCombinations %}
											<h3>
												{% if data.startAt == data.endAt %}
													{% if startFormatted not in displayedStarts %}
														{{ startFormatted }}<br>
														{% set displayedStarts = displayedStarts|merge([startFormatted]) %}
													{% endif %}
												{% else %}
													{{ combination }}<br>
												{% endif %}
											</h3>
											{% set displayedCombinations = displayedCombinations|merge([combination]) %}
										{% endif %}
									{% endfor %}
								</div>
								<div class="ticket-card-info-festival text-center mt-3">
									{% set displayedFees = [] %}
									<!-- Afficher les fees différents avec leurs prix associés -->
									{% for p in pass.data %}
										{% if p.fee not in displayedFees %}
											<div class="row mb-3 align-items-center">
												<div class="col-md-6 text-right">
													<span class="ticket-card-info-festival-goer">{{ p.fee }}:</span>
												</div>
												<div class="col-md-6">
													<span class="ticket-card-info-price">
														{% if p.price == 0 %}
															GRATUIT
														{% else %}
															{{ p.price }}€
														{% endif %}
													</span>
												</div>
											</div>
											{% set displayedFees = displayedFees|merge([p.fee]) %}
										{% endif %}
									{% endfor %}
								</div>
								<!-- Buying Button -->
								<div class="col-md-12 text-center mt-3">
									<a href="#" class="btn btn-primary light-yellow-bg dark-blue-txt">Acheter maintenant</a>
								</div>
							</div>
						</div>
					</div>
				{% endif %}
			{% endfor %}

		</div>

		<!-- Weezevent Ticketing Service -->
		<div class="weezevent container-fluid gx-0">
			<div
				class=" medium-blue-bg py-3">

				<!-- Weezevent URL -->
				<a title="Logiciel billetterie en ligne" href="https://widget.weezevent.com/ticket/E1146829/?code=68626&locale=fr-FR&width_auto=1&color_primary=0032FA" class="weezevent-widget-integration btn btn-primary btn-block" data-src="https://widget.weezevent.com/ticket/E1146829/?code=68626&locale=fr-FR&width_auto=1&color_primary=0032FA" data-width="100%" data-height="600" data-id="1146829" data-resize="0" data-width_auto="0" data-noscroll="0" data-use-container="yes" data-type="neo" target="_blank">Billetterie
																																																																																																																		                        Weezevent</a>
			</div>
		</div>
	</div>

{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="https://widget.weezevent.com/weez.js" type="text/javascript"></script>
{% endblock %}
